<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.15" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Matthew Phillips &middot; Matthew Phillips </title>

  
  <link rel="stylesheet" href="https://matthewphillips.info/css/poole.css">
  <link rel="stylesheet" href="https://matthewphillips.info/css/syntax.css">
  <link rel="stylesheet" href="https://matthewphillips.info/css/hyde.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/zenburn.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://matthewphillips.info/.xml" rel="alternate" type="application/rss+xml" title="Matthew Phillips" />
</head>

<body class="">

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://matthewphillips.info/"><h1>Matthew Phillips</h1></a>
      <p class="lead">
       Home on the World Wide Web 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
    </ul>

    <p>&copy; 2016. All rights reserved. </p>
  </div>
</div>


    <div class="content container">
<div class="posts">

      
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/how-hot-swapping-works.html">
        How hot module swapping works
      </a>
    </h1>

    <span class="post-date">Thu, Oct 8, 2015</span>

    

<p><a href="http://stealjs.com/">Steal</a> added hot module swapping (aka live reload, aka hot module replacement) about 6 months ago, but how it works isn&rsquo;t obvious, so I thought I&rsquo;d write about it. You can read more about the feature and how to use it <a href="http://blog.bitovi.com/hot-module-replacement-comes-to-stealjs/">here</a>.  This article is more technical and explains what happens under the hood. Don&rsquo;t worry, there&rsquo;s nothing overly complex here and it&rsquo;s rather easy to understand once you understand dependency graphs.</p>

<h2 id="dependency-graph:25c0b94280c805f269bc8221d9711bc9">Dependency graph</h2>

<p>When you load your app using Steal (or any other module loader) it saves the modules in a registry.  A registry is just an object where the keys are the module names (like <strong>lodash</strong>) and the values are the module values (like a function or an object; whatever it is you export from the module).</p>

<p>With Steal we retain another data structure that lists modules (by their module name) and metadata about them, specifically what their dependencies are. We call this the <strong>dependency graph</strong>.  It looks something like this:</p>

<pre><code class="language-js">{
  &quot;lodash&quot;: {
    &quot;dependencies&quot;: []
  },
  &quot;jquery&quot;: {
    &quot;dependencies&quot;: []
  },
  &quot;my/custom/element&quot;: {
    &quot;dependencies&quot;: [&quot;jquery&quot;, &quot;lodash&quot;]
  },
  &quot;my/main/app&quot;: {
    &quot;dependencies&quot;: [&quot;jquery&quot;, &quot;my/custom/element&quot;]
  }
}
</code></pre>

<p>It&rsquo;s pretty simple.  Each key is a module name and the value is an object that contains metadata; most importantly is an array of the module&rsquo;s dependencies.</p>

<h2 id="file-watcher:25c0b94280c805f269bc8221d9711bc9">File watcher</h2>

<p>To know when a module changes we need a server that watches for file changes. This is what happens when you run <code>steal-tools live-reload</code>.</p>

<p>The live-reload server gets the dependency graph of your project and listens for file changes to each module. The dependency graph shown above also has a property called <strong>address</strong> that is the path to the module&rsquo;s file. We add a file watcher to every file in the graph so that we know when work has been saved.</p>

<p>When you open a page in your app with the live-reload server running it establishes a connection to that server with a <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API">WebSocket</a>. By default it uses port 8012.</p>

<p>The file watcher will see changes to the files in the dependency graph and send a message through the WebSocket back to the browser with the name of the module that changed.</p>

<h2 id="tearing-down-the-graph:25c0b94280c805f269bc8221d9711bc9">Tearing down the graph</h2>

<p>Back on the browser side, it receives the WebSocket message with the name of the module that changed. Since the module changed we need to re-import it. But we also need to re-import it&rsquo;s parent modules (the modules that import it) and the parent&rsquo;s then need to import their parents, etc. all the way up the graph.</p>

<p>This might sound wrong to you; why do you need to re-import the parent modules?  Consider this example:</p>

<h3 id="module-a:25c0b94280c805f269bc8221d9711bc9">Module A</h3>

<pre><code class="language-js">module.exports = function(){
  return &quot;foo&quot;;
};
</code></pre>

<h3 id="module-b:25c0b94280c805f269bc8221d9711bc9">Module B</h3>

<pre><code class="language-js">var moduleA = require(&quot;module-a&quot;);

moduleA(); // -&gt; &quot;foo&quot;
</code></pre>

<p>And then consider that module A changes to this:</p>

<h3 id="module-a-1:25c0b94280c805f269bc8221d9711bc9">Module A</h3>

<pre><code class="language-js">module.exports = function(){
  return &quot;bar&quot;;
};
</code></pre>

<p>If we don&rsquo;t re-import Module B then it will continue to have a reference to the old Module A function that returns &ldquo;foo&rdquo;. In JavaScript once you have a reference to an object or a function that reference can never be changed by external code.</p>

<p>So to solve this we simply walk up the dependency graph and get a list of modules that need to be reloaded. Consider the original example graph:</p>

<pre><code class="language-js">{
  &quot;lodash&quot;: {
    &quot;dependencies&quot;: []
  },
  &quot;jquery&quot;: {
    &quot;dependencies&quot;: []
  },
  &quot;my/util&quot;: {
    &quot;dependencies&quot;: []
  },
  &quot;my/custom/element&quot;: {
    &quot;dependencies&quot;: [&quot;jquery&quot;, &quot;lodash&quot;, &quot;my/util&quot;]
  },
  &quot;my/main/app&quot;: {
    &quot;dependencies&quot;: [&quot;jquery&quot;, &quot;my/custom/element&quot;]
  }
}
</code></pre>

<p>Let&rsquo;s say my/util changes. Its only has one parent (the modules that depend on it), my/custom/element. However my/main/app depends on my/custom/element so we have to reload that as well. We tear down the graph by removing these modules from the registry. Afterwards the graph looks like:</p>

<pre><code class="language-js">{
  &quot;lodash&quot;: {
    &quot;dependencies&quot;: []
  },
  &quot;jquery&quot;: {
    &quot;dependencies&quot;: []
  }
}
</code></pre>

<p>Just lodash and jquery remain. We reimport the top-level parent module after walking all the way up the graph, in our case it is my/main/app. By reimporting the top-level parent it will reimport the modules that have been deleted from the registry, here it is my/custom/element and my/util. However any other dependencies, such as jquery and lodash, are not reimported because they are already in the registry.</p>

<p>Steal contains several optimizations that makes the reloading blazing fast. For most changes you&rsquo;ll see your changes reflected in under 100ms.</p>

<p>The basic operation of what Steal does to reload modules is quite simple. The hard work comes from plugins and code that use the live-reload APIs. In the future I&rsquo;d like to write a bit more on what these plugins do and how <em>they</em> work as well.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/gist-based-blogging.html">
        Building a gist-based blogging tool
      </a>
    </h1>

    <span class="post-date">Thu, Sep 3, 2015</span>

    

<h2 id="motivation:8e640688c7cd28ded2c6b3d7a1f5d66d">Motivation</h2>

<p>For the past several years I have been using <a href="http://www.cabinjs.com/">Cabin</a> for my personal blog. Cabin works like most other static site generators in the vein of <a href="http://jekyllrb.com/">Jekyll</a>; you write your posts in markdown in a posts folder, your templates in a template folder, run a script and it generates the HTML for your blog. Simple enough.</p>

<p>The problem I&rsquo;ve always had with this setup is that it has just enough friction that I wind up not blogging as often as I would like. During your &ldquo;draft&rdquo; stage you still have most of the same steps as when you finally deploy. You have to clone your site, create a branch to write a new post in, write, commit and push. When I have inspiration to write I want to just write, not manage a project.</p>

<p>So what I usually do is write my posts in Gist or Google Docs and then move them to my site project when I&rsquo;m done. I started thinking, what if I could remove the blog engine entirely?</p>

<p>My first thought was to set up a server that just served Gists directly. To this end I set up an <a href="http://expressjs.com/">Express</a> server that did exactly that.  I had a Gist that I <a href="https://gist.github.com/matthewp/695b163d39f68ec73678">used as my index</a> of all Gists I wanted to be served. The front page was just a list of links to each article with the url containing the Gist id.</p>

<p>To make this work with my existing posts I needed to convert them to gists. This was more work than I expected. Cabin uses a non-standard front-matter format. Most blog engines use YAML but Cabin uses a JavaScript-like syntax.  I would have expected it to be JSON but it&rsquo;s not, the keys are not strings. To figure out how they did this I had to dig through their source and found it <a href="https://github.com/CabinJS/grunt-pages/blob/4cd264fce21fb8d90198edadeccb3961b37537bc/tasks/pages.js#L269">buried in a Grunt task</a>. It was easy enough to extract this code and reuse it for my needs. Each gist contains the markdown content (minus the front-matter) and a <code>metadata.json</code> file containing the front-matter (now json).</p>

<p>This all worked well enough but I felt uneasy about pulling directly from Gist to serve the blog posts. It just felt wasteful, even if I included caching that prevented it from fetching the gists on each requests. Additional it broke my old links. I played around with the idea of having a &ldquo;slug&rdquo; that would serve as the id for a post, but this meant I would need to pull that index gist to find out which gist id the slug referred to. Again, not terrible, just more code than I wanted.</p>

<h2 id="one-thing-well:8e640688c7cd28ded2c6b3d7a1f5d66d">One thing well</h2>

<p>I&rsquo;ve always been a fan of the Unix philosophy of doing one thing well, so I started to think why not construct the posts using basic cli tools already available. You can easily pull down a gist using the GitHub API and then use a series of other tools to generate the html. The full bash script can be seen below, but here&rsquo;s the pseudo-code of what happens:</p>

<pre><code class="language-shell">curl https://api.github.com/gists/$GIST_ID | \
jq '.files[.files | keys[0]].content' | \
marked | hb -i post.handlebars
</code></pre>

<p>It&rsquo;s pretty simple, let me explain what easy step does:</p>

<h3 id="curl-api-github-com:8e640688c7cd28ded2c6b3d7a1f5d66d">curl api.github.com</h3>

<p>Luckily pulling down gists is really easy with the GitHub API. Unless you are doing it a lot, and likely programmatically, you don&rsquo;t even need to set up an auth token, but you can do this if you want. It returns a JSON containing a lot of data, but we really just want the post content.</p>

<h3 id="jq:8e640688c7cd28ded2c6b3d7a1f5d66d">jq</h3>

<p><a href="http://stedolan.github.io/jq/">jq</a> is an amazing command-line JSON parser. In its simplest form jq can be used as a prettifier, but you can do advanced stuff to extract just the parts that you need.</p>

<p>Its power is shown here because the gist JSON structure makes it slightly difficult to extract the post content. This is because instead of having an array of <code>files</code> it has an object where the file name is the key. This is fine for when you know the name of a file, but in my case I just wanted to assume that the first file in a gist is the markdown.</p>

<p>Lucky jq can easily handle this. Consider the structure is like this:</p>

<pre><code class="language-json">{
  &quot;files&quot;: {
    &quot;foo.md&quot;: {
      &quot;something&quot;: &quot;else&quot;,
      &quot;content&quot;: &quot;# Title\nsome test\n* a list&quot;
    }
  }
}
</code></pre>

<p>With jq you can run <code>jq '.files[.files | keys[0]].content'</code>. This gets <code>.files</code> and then uses the <code>keys</code> function to get all of the keys of the files object and uses the key indexed 0 to get the &ldquo;foo.md&rdquo; object and finally we want <code>.content</code> which is the markdown.</p>

<h3 id="marked:8e640688c7cd28ded2c6b3d7a1f5d66d">marked</h3>

<p><a href="https://github.com/chjj/marked">marked</a> is the premier markdown compiler (to html) for JavaScript. Luckily it include a command-line tool that takes markdown from stdin and spits out html to stdout. Perfect.</p>

<p>One downside is that it doesn&rsquo;t include a way to highlight code. If using the Node.js API you can set options which includes using a highlighter of your choice. I usually use <a href="https://highlightjs.org/">hightlight.js</a>. With that the code would be something like:</p>

<pre><code class="language-js">var marked = require(&quot;marked&quot;);

marked.setOptions({
  highlight: function(){
    return require(&quot;highlight.js&quot;).highlightAuto(code).value;
  }
});
</code></pre>

<p>This is an <a href="https://github.com/chjj/marked/issues/110">open issue</a> about how this could be used with the cli. My suggestion was to provide a module that exports options. This way you could write the above code as:</p>

<pre><code class="language-js">var marked = require(&quot;marked&quot;);

module.exports = {
  highlight: function(){
    return require(&quot;highlight.js&quot;).highlightAuto(code).value;
  }
};
</code></pre>

<p>And feed that option into the <code>marked</code> cli.  It becomes:</p>

<pre><code>cat my-post.md | marked --options /path/to/options.js
</code></pre>

<p>They <a href="https://github.com/chjj/marked/pull/613">haven&rsquo;t yet accepted</a> this change but I do have it working in my own fork.</p>

<h3 id="hb:8e640688c7cd28ded2c6b3d7a1f5d66d">hb</h3>

<p>Having gone from gist into json into markdown into html, the final step is to run the produced html through a template engine so that the article is contained within a full page. Since I&rsquo;m already very familiar with the Mustache syntax in my day job I decided to use <a href="http://handlebarsjs.com/">handlebars</a> for templates. A simple post template can be:</p>

<pre><code class="language-handlebars">&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;{{title}} | My Blog&lt;/title&gt;
  &lt;link href=&quot;some.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;article&gt;
    {{{content}}}
  &lt;/article&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>We just need to feed the generated html through this template to generate a post. I couldn&rsquo;t find a project that did exactly what I need; take json and a template and produce html, so I forked a close-enough project and adjusted it, creating <a href="https://www.npmjs.com/package/handlebars-render">handlebars-render</a> which does this.  You can use it like:</p>

<pre><code class="language-shell">echo '{&quot;foo&quot;: &quot;bar&quot;}' | hb -i page.handlebars
</code></pre>

<p>The output of <strong>marked</strong> is fed into this script. I use a <code>metadata.json</code> file in my gist that provices the post date, title, and tags (which I don&rsquo;t currently support, but could in the future).  Usage winds up like:</p>

<pre><code class="language-shell">DATA=&quot;{\&quot;id\&quot;: $ID, \&quot;title\&quot;: $TITLE, \&quot;content\&quot;: $HTML, \&quot;metadata\&quot;: $METADATA, \&quot;date\&quot;: $DATE}&quot;
echo $DATA | hb -i templates/post.handlebars
</code></pre>

<p>There&rsquo;s probably a better way to create a json string (perhaps with jq) but this works well enough for my needs.</p>

<h2 id="putting-it-all-together:8e640688c7cd28ded2c6b3d7a1f5d66d">Putting it all together</h2>

<p>And that&rsquo;s it! With those core scripts I can easily put everything together that generates html. My script is simple:</p>

<pre><code class="language-shell">#!/bin/bash
GIST_ID=$1

IFS='%'

GIST_JSON=`curl -H &quot;Authorization: token $GITHUB_TOKEN&quot; -s https://api.github.com/gists/$GIST_ID`

CONTENT=`echo $GIST_JSON | jq '.files[.files | keys[0]].content'`
METADATA=`echo $GIST_JSON | jq -r '.files[&quot;metadata.json&quot;].content'`
HTML=`echo $CONTENT | jq -r '.' | marked --options marked_options.js | jq -s -R '.'`

# Get the title either from metadata.title or .description
TITLE=`[[ &quot;$METADATA&quot; == &quot;null&quot; ]] &amp;&amp; echo $GIST_JSON | jq '.description' || echo $METADATA | jq '.title'`
ID=`echo $GIST_JSON | jq &quot;.id&quot;`
DATE=\&quot;`[[ &quot;$METADATA&quot; == &quot;null&quot; ]] &amp;&amp; echo &quot;foo&quot; || echo $METADATA | jq -r '.date' | xargs -I{} gdate -d {} +%Y-%m-%d`\&quot;

DATA=&quot;{\&quot;id\&quot;: $ID, \&quot;title\&quot;: $TITLE, \&quot;content\&quot;: $HTML, \&quot;metadata\&quot;: $METADATA, \&quot;date\&quot;: $DATE}&quot;

echo $DATA | hb -i templates/post.handlebars
</code></pre>

<p>There&rsquo;s some backwards compatible stuff happening in the script or it would be even shorter; but even as it stands I&rsquo;ll take a fairly easy to read 20 LOC script as the basis for my blog any day. All that is needed is a environment variable <code>GITHUB_TOKEN</code> and a gist id provided as the first parameter and the script will spit out html.</p>

<p>I&rsquo;ve got other scripts that do things like generate the index.html page and a script that will generate all posts (I keep a <code>posts</code> file that just lists the gist id and slug for these purposes).</p>

<p>I&rsquo;m relatively happy that I&rsquo;ve been able to create an extremely light weight &ldquo;static site generate&rdquo; that&rsquo;s just scripted small utilities.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/using-npm-with-systemjs.html">
        Using NPM with SystemJS
      </a>
    </h1>

    <span class="post-date">Thu, Apr 23, 2015</span>

    

<p><a href="https://github.com/stealjs/system-npm">system-npm</a> is an amazing plugin for SystemJS that enables you to load your NPM dependencies with zero configuration.  Just load system-npm and then load your project; require your NPM dependencies just as if you were in Node.</p>

<p>To use system-npm with SystemJS you&rsquo;ll first want to install SystemJS into your project.  In this post we&rsquo;re assuming you&rsquo;ve included <code>system.js</code> and <code>es6-module-loader.js</code> in a <code>vendor/</code> folder, but you can place it where-ever you want. Then simply add a script tag to your page to load SystemJS:</p>

<pre><code>&lt;script src=&quot;vendor/system.js&quot;&gt;&lt;/script&gt;
</code></pre>

<h2 id="installing:af17117141c48fe88e78f51384579396">Installing</h2>

<p><strong>system-npm</strong> is installed through NPM (of course!):</p>

<pre><code>npm install system-npm --save-dev
</code></pre>

<h2 id="configuring:af17117141c48fe88e78f51384579396">Configuring</h2>

<p>Next you&rsquo;ll want to configure SystemJS to know where to load the plugin. Create a <code>config.js</code> file and add the appropriate config:</p>

<pre><code>System.config({
	map: {
		&quot;npm&quot;: &quot;system-npm&quot;,
		&quot;npm-extension&quot;: &quot;system-npm/npm-extension&quot;
	},
	paths: {
		&quot;system-npm/*&quot;: &quot;node_modules/system-npm/*.js&quot;
	}
});
</code></pre>

<p>This tells SystemJS how to load system-npm. Add the configuration script to your page after SystemJS:</p>

<pre><code>&lt;script src=&quot;config.js&quot;&gt;&lt;/script&gt;
</code></pre>

<h2 id="load-your-app:af17117141c48fe88e78f51384579396">Load your app</h2>

<p>Now that it is configured you can load your <code>package.json</code> using the plugin and then start up your applicaiton:</p>

<pre><code>&lt;script&gt;
	System.import(&quot;package.json!npm&quot;).then(function(){
		System.import(&quot;app/app&quot;);
	});
&lt;/script&gt;
</code></pre>

<h2 id="develop:af17117141c48fe88e78f51384579396">Develop</h2>

<p>From here you can develop as you wish, sharing the same dependencies between Node and the Browser. <strong>system-npm</strong> will load your package.json and use the metadata. If you want to limit it to only loading your client-side deps, you can specify this in your configuration:</p>

<pre><code>System.config({
  npmDependencies: [
    &quot;jquery&quot;,
    &quot;backbone&quot;
  ]
});
</code></pre>

<p>Doing this, system-npm will only load <em>jquery</em> and <em>backbone</em> as dependencies.</p>

<p>It&rsquo;s that simple. system-npm is a great way to instantly make your SystemJS projects nearly configuration-free.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/organizing-your-library-project-with-stealjs.html">
        Organizing your library project with StealJS
      </a>
    </h1>

    <span class="post-date">Tue, Mar 31, 2015</span>

    

<p>With <a href="http://stealjs.com/">StealJS</a> you can easily set up an open-source library that fits with the way you like to organize your code. A common directory structure might look like this:</p>

<pre><code>- src
  - main.js
  - dep.js
- test
  - test.html
  - test.js
package.json
Gruntfile.js
</code></pre>

<p>In order to keep a shallow folder structure we&rsquo;ve divided the library&rsquo;s source code in <code>src</code> and its tests in <code>test</code>. The root directory only contains our <code>package.json</code> and a <code>Gruntfile.js</code> for builds.</p>

<p>With this structure you might try to install your module with NPM:</p>

<pre><code class="language-shell">npm install my-module --save
</code></pre>

<p>And then load it in your project:</p>

<pre><code class="language-js">import myModule from &quot;my-module&quot;;
</code></pre>

<p>However this will fail because your <code>main</code> is not pointing to right place. Imagine your <code>main.js</code> look like:</p>

<pre><code class="language-js">import dep from &quot;my-module/dep&quot;;
</code></pre>

<p>Steal will look for <code>dep.js</code> in the project&rsquo;s root folder. To set an alternative root, correctly called the lib folder, set it in the <code>package.json</code>:</p>

<pre><code class="language-json">{
  &quot;name&quot;: &quot;my-module&quot;,
  &quot;main&quot;: &quot;dist/cjs/main.js&quot;,
  &quot;system&quot;: {
    &quot;main&quot;: &quot;main&quot;,
    &quot;directories&quot;: {
      &quot;lib&quot;: &quot;src&quot;
    }
  }
}
</code></pre>

<p>This tells Steal that your library&rsquo;s code is nested under the <code>src</code> folder. This makes it easy to refer to your module by name in its internal code. With your test do the same thing:</p>

<pre><code class="language-js">import myModuleDep from &quot;my-module/dep&quot;;
</code></pre>

<p>Will correctly load <code>src/dep.js</code> if that&rsquo;s the module you want to test.</p>

<h2 id="building:54829a1cb3a64537a249d84efe4fc1a9">Building</h2>

<p>If you&rsquo;re only target Steal you can go ahead and publish your module on NPM. But if you want to reach users of other module loaders you should set up a build script. <a href="http://stealjs.com/docs/steal-tools.html">steal-tools</a> makes this easy. For example if using Grunt:</p>

<pre><code class="language-js">grunt.initConfig({
  &quot;steal-export&quot;: {
    dist: {
      system: {
        config: &quot;package.json!npm&quot;
      },
      outputs: {
        &quot;+cjs&quot;: {},
        &quot;+amd&quot;: {},
        &quot;global-js&quot;: {]
      }
    }
  }
});
</code></pre>

<p>Then by simply running <code>grunt steal-export</code> will produce <code>dist/cjs</code>, <code>dist/amd</code>, and <code>dist/global</code> folders containing code that will run in RequireJS, Browserify, and as a browser global. Read <a href="http://stealjs.com/docs/StealJS.project-exporting.html">the full guide</a> on setting up an export for your project for more.</p>

<p>See <a href="https://github.com/bitovi-components/bit-tabs">bit-tabs</a> for a full example of this directory structure in action.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/im-sold-on-html-based-templating.html">
        I&#39;m Sold on HTML-based Templating
      </a>
    </h1>

    <span class="post-date">Tue, Jan 27, 2015</span>

    

<p>I&rsquo;ve finally come around to liking HTML-based templates. I&rsquo;ve been a hold-out for a long time but I&rsquo;m finding it harder and harder to resist the tide and I&rsquo;m officially calling it today; HTML templates have won.</p>

<p>What am I talking about? If you&rsquo;ve done heavy JavaScript developer since, well the dawn of time, you&rsquo;re probably used to creating templates a lot like this:</p>

<pre><code>&lt;script type=&quot;text/mustache&quot; id=template&quot;&gt;
  &lt;div&gt;&lt;span&gt;Hello&lt;/span&gt; {{name}}&lt;/div&gt;
&lt;/script&gt;
</code></pre>

<p>This is a hack, always has been. The script tag was never intended to hold arbitrary strings for later processing, but it does, so it&rsquo;s always been a good fit for templates. Then Web Components came around (which I&rsquo;ve written about <a href="http://dailyjs.com/2014/03/10/components-controls/">here</a>) and introduced the <code>&lt;template&gt;</code> tag. The template tag brought some major benefits; namely that the content is parsed but not executed. This means that a template can have <code>&lt;script&gt;</code> tags with JavaScript, CSS, etc. and none of it is ran until the template is inserted into the page.</p>

<p>This is great! This means you can define, for example, a custom element and it&rsquo;s template, then have some JavaScript to execute on insert. Then to activate a template all you have to do is use <code>document.importNode</code> and insert it anywhere you like and <em>boom</em>, it&rsquo;s like inserting new HTML into the page.</p>

<h2 id="how-things-changed:877b2f6ba80dcf31bf51d654e0e70934">How Things Changed</h2>

<p>The problem with templates has always been that they do not define a data-binding strategy. And for obvious reasons they can&rsquo;t. Can you imagine Mozilla, Google, Microsoft, Apple and others all agreeing on, for example, Mustache as the data-binding language for templates? No way! Never going to happen. And because of that we only get basic HTML. The problem is that basic HTML isn&rsquo;t all that great for dynamic creation. It&rsquo;s just XML, and XML just has tags and attributes. That doesn&rsquo;t have the power of a string-concatenation-based templating language like Mustache.</p>

<p>But it doesn&rsquo;t matter. Angular has shown that HTML-based templating can work. And devs have spoken; we like to put the HTML straight into the page. Adding script tags or importing HTML from a module-loader feels foreign and weird.</p>

<p>So the question becomes, will there be a standard developed around HTML-based templates? Probably not. But there are certainly a variety of patterns that are emerging, such as <code>for-each=&quot;items&quot;</code> to iterate a list. One of my colleagues <a href="https://twitter.com/daffl">David Luecke</a> released <a href="http://daffl.github.io/breezy/">HTML Breezy</a> recently, a Virtual-DOM backed HTML based templating engine that runs in both Node and the browser. So me, I&rsquo;m sold. My next templating language will be HTML. The <code>&lt;template&gt;</code> tag is too compelling to continue to ignore.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/if-books-had-been-invented-for-the-web.html">
        If Books Had Been Invented for the Web
      </a>
    </h1>

    <span class="post-date">Wed, Jan 14, 2015</span>

    

<p>One of my ongoing curiosities is with how to design books for the web. Although there are many good books available on the web, I haven’t encountered one that is more than just the book contents with some <code>&lt;p&gt;</code> tags intermingled. The web has many unique advantages that makes it ideal for reading, but for whatever reason it hasn’t translated to long-form text (anything longer than a single article) very successfully.</p>

<h2 id="scrolling:61511b7706148a5ecd8d6420e16bc75c">Scrolling</h2>

<p>Perhaps the web’s most unique characteristic is that documents can scroll, unlike books which are paginated. This is major when it comes to content because there’s a threshold at which scrolling becomes too much. With books you can keep track of your progress easily by which page you are on. Since pages are uniform it’s easy to know how far you’ve gone and to mentally tag how far you want to go.</p>

<p>With scrolling on the web that breaks down. You can still have chapters (although I’m not sure that you should) but that’s not a great unit for tracking progress. I’ve noticed some designs that keep track of how far you have scrolled down the page as you read; I think that’s a good way to give yourself a mental understanding of your progress. Additionally some sites (and I’ve experimented with this myself) have a badge saying how long it will take to read the article. I don’t think this works well if the time is greater than 10 minutes or so.</p>

<p>A key with me with web design is not to reject the unique characteristics of the web, but instead embrace them. Scrolling goes hand-in-hand with the web. Figuring this part out is tantamount to any other aspect if you want to nail the reading experience.</p>

<p>Remember that scrolling is fun. The user should be able to scroll up and down quickly. Keep their place but perhaps only their forward progress.</p>

<h2 id="custom-layouts:61511b7706148a5ecd8d6420e16bc75c">Custom Layouts</h2>

<p>This is one that is completely overlooked by books on the web that I’ve seen. With the web you have the ability to customize the layout of every page; or even sections within a page. Imagine you were writing a story like Lord of the Rings. Within a single chapter (as the user scrolls) you might have a lighter theme while the heroes are in the land of the elves, then a forest theme for when they are traveling through the woods, and finally a darker theme when they enter Mordor. Parallax scrolling is trendy and overdone, but this could be one place where it works.</p>

<p>You have ultimate freedom on the web so you can take this as far as you want. Carefully timed music might be appropriate, and animations are a possibility. Of course you want to be careful not to distract from the story, but that’s an issue with any medium. My point is simply that these capabilities are in play and should be used.</p>

<h2 id="linkability:61511b7706148a5ecd8d6420e16bc75c">Linkability</h2>

<p>Web documents are linkable; in fact they want to be linked. A book written for the web would take advantage of this. An informational book would be full of links to relative resources; there’s no reason to have footnotes when you have the web. If you want to call-out some text a popover would be appropriate for that.</p>

<p>Links shouldn’t be just out, but within the book as well. If referring to an event that took place several chapters back, link to it!</p>

<h2 id="the-web-medium:61511b7706148a5ecd8d6420e16bc75c">The Web Medium</h2>

<p>The web is an interesting medium because it’s an amalgam of all the others that have come before it. If we approach writing for the web as an art-form in it’s own right we’ll better be able to craft pages that come to life and make the web reading experience something that people seek out.</p>

<p>Keeping in mind that the story is most important is key. I wouldn&rsquo;t make a web-based reading experience an &ldquo;app&rdquo;. Any interactivity should be flourishes that support the reading, so I wouldn&rsquo;t be in favor of persistent UI and almost nothing should be clickable (except all of those links of course). Navigation is not something I&rsquo;ve touched on in this article but one that I&rsquo;ve thought a lot about. Since we&rsquo;re keeping track of the users progress we can help them jump to the last place they were; but I haven&rsquo;t come up with a good design for this. A table of contents doesn&rsquo;t make much sense either. When you talk to friends about a book you don&rsquo;t refer to &ldquo;Chapter 12&rdquo;, you refer to &ldquo;that part where the killer was revealed&rdquo;. In that regard perhaps the contents should be grouped by &ldquo;experiences some how&rdquo;.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/responsive-computes.html">
        Responsive Computes
      </a>
    </h1>

    <span class="post-date">Sun, May 11, 2014</span>

    

<p>Recently I was working on a template and ran into issues trying to make it responsive purely using CSS media queries. The problem is that the mark-up of the mobile view and that of the desktop were just too different. In fact, the <em>functionality</em> of the two views were a bit different as well.</p>

<p>At this point you might give up and just write up two separate templates and use media queries to hide one of them. Bootstrap even <a href="http://getbootstrap.com/css/#responsive-utilities-classes">has classes</a> for just such a case.</p>

<p>Luckily, however, there is the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window.matchMedia">matchMedia</a> API that brings the power of media queries to JavaScript. There&rsquo;s fairly broad <a href="http://caniuse.com/#feat=matchmedia">browse support</a> and even <a href="https://github.com/weblinc/media-match/blob/master/media.match.js">a polyfill</a> if you want support in older IE browsers. matchMedia allows you to use the same type of media queries in JavaScript that you can use in CSS, for example:</p>

<pre><code class="language-javascript">var mql = matchMedia('only screen and (max-width: 768px)');
mql.matches === true; // true if the screen is &lt;= 768px
</code></pre>

<p>Additionally matchMedia queries include an <code>addListener</code> function that takes a callback that will be called when the media query&rsquo;s status changes; meaning you can resize the browser and the media query will respond when the screen becomes less than 768px (for example).</p>

<h2 id="live-bound-responsive-templates:cbd5bbeacf0ac7aaf34e852d78b9967e">Live-bound responsive templates</h2>

<p>If you use CanJS you&rsquo;re familiar with can.computes, but you might not be familiar with the <a href="http://canjs.com/docs/can.compute.html#sig_can_compute_initialValue__settings__">2nd signature</a> which allows you to create a compute from any type of event emitting object. This means we can easily turn our matchMedia query into a compute that can be used in templates:</p>

<pre><code class="language-javascript">var mql = matchMedia('only screen and (max-width: 768px)');

var mobile = can.compute(mql.matches, {
  get: function(){
    return mql.matches;
  },
  set: function(){
    // Do nothing for this one
  },
  on: function(updated){
    mql.addListener(updated);
  },
  off: function(updated){
    mql.removeListener(updated);
  }
});
</code></pre>

<p>The compute&rsquo;s <code>settings</code> object describes how to bind the compute to the media query and respond to changes. Now your templates can be responsive in a much more powerful way than what CSS allows:</p>

<pre><code class="language-handlebars">{{#if mobile}}
  &lt;div&gt;Hi there phone! Mobile navigation goes here.&lt;/div&gt;
{{else}}
  &lt;div&gt;Totally different desktop experience!&lt;/div&gt;
{{/if}}
</code></pre>

<p>The broader lesson here is that <a href="http://canjs.com/docs/can.compute.html">can.computes</a> are crazy powerful. If you&rsquo;re only using them to respond to changes in your business logic you&rsquo;re not unlocking their full potential. The browser provides many APIs, like matchMedia, that can be bound to. Check out the <a href="http://bitovi.com/blog/2013/04/weekly-widget-compute-slider.html">video slider</a> and be inspired.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/fun-with-shadow-dom.html">
        Fun with Shadow DOM
      </a>
    </h1>

    <span class="post-date">Wed, Apr 2, 2014</span>

    

<p><strong>Update</strong>: To do this demo you first need to enable experimental web platform features <a href="chrome://flags/#enable-experimental-web-platform-features">in chrome://flags</a>.</p>

<p>Now that Chrome has shipped Shadow DOM we can start experimenting with what possibilities are going to open up to developers. Consider this a beginner/intermediate post about Shadow DOM. I assume you already know Shadow DOM is a way to &ldquo;hide&rdquo; an element&rsquo;s structure while opening up insertion points to its inner content.</p>

<p>With that in mind, this is a simple exercise in seeing the weirdness that is Shadow DOM. So open up a text editor and create an HTML file with these contents:</p>

<pre><code class="language-html">&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Fun with Shadow&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;container&quot;&gt;&lt;/div&gt;
&lt;template id=&quot;tmpl&quot;&gt;
  &lt;style&gt;div { color: red; }&lt;/style&gt;
  &lt;div&gt;Hello &lt;span class=&quot;name&quot;&gt;Matthew&lt;/span&gt;&lt;/div&gt;
&lt;/template&gt;
&lt;template id=&quot;tmpl2&quot;&gt;
  &lt;div&gt;Welcome to the internet&lt;/div&gt;
  &lt;shadow&gt;&lt;/shadow&gt;
&lt;/template&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>From here on the rest of the tutorial is done from Chrome&rsquo;s DevTools. So open your brower and navigate to the page you just created and open the DevTools. This is a simple page with a container div and a couple of templates.</p>

<p>You should see nothing on your page at this point, but we&rsquo;ll change that. The element <code>&lt;div id=&quot;container&quot;&gt;&lt;/div&gt;</code> is the root element we&rsquo;re going to play around with so go ahead and get a reference to it.</p>

<pre><code class="language-javascript">c = document.querySelector('#container');
</code></pre>

<p>Next we&rsquo;re going to create this div&rsquo;s <a href="http://www.w3.org/TR/shadow-dom/#dfn-shadow-root">shadow root</a>. The shadow root is the place where you can append stuff to the div and not have to worry about the page&rsquo;s styling interfering (among other advantages).</p>

<p>Before we create the shadow root, type this into the console and hit enter:</p>

<pre><code class="language-javascript">c.shadowRoot
</code></pre>

<p>It should return <code>null</code>, as the div doesn&rsquo;t have a shadow root yet. So let&rsquo;s go ahead and change that. Create the shadow root and keep a reference for later:</p>

<pre><code class="language-javascript">root1 = c.createShadowRoot();
</code></pre>

<p>Should return (in the console):</p>

<pre><code>#shadow-root
</code></pre>

<p>This also updates <code>c.shadowRoot</code>. Test it by doing:</p>

<pre><code class="language-javascript">root1 === c.shadowRoot
</code></pre>

<p>And you&rsquo;ll get <code>true</code>. Awesome. Now that you have a shadow root you&rsquo;ll want to add stuff to it. This works like any other element. You can use <code>innerHTML</code>, <code>appendChild</code>, <code>insertBefore</code>, etc. to add content to the shadow. Let&rsquo;s use our first template to attach some content:</p>

<pre><code class="language-javascript">root1.appendChild(document.querySelector('#tmpl').content)
</code></pre>

<p>The immediate effect you&rsquo;ll see is the words &ldquo;Hello Matthew&rdquo; in red on the page. This is because the template contains a <code>&lt;style&gt;</code> tag that styles the content within the template.</p>

<p>You&rsquo;ll also notice that we <em>didn&rsquo;t</em> append the template, we appended the template&rsquo;s <code>content</code> property. This is a read-only property containing a document fragment of the template&rsquo;s content.</p>

<p>If you navigate to the DevTools&rsquo; <strong>Elements</strong> tab and expand the <code>#container</code> div you&rsquo;ll see&hellip; nothing at all. This is because shadow root is hidden by default. You can change this by going into Settings -&gt; Elements and selecting <em>Show Shadow DOM</em>. Now go back to <strong>Elements</strong> and you&rsquo;ll see a <code>#shadow-root</code> nested under your div. Yay!</p>

<h2 id="deeper-down-the-rabbit-hole:ab0b2cc8ea22be5cc903803301e18c98">Deeper down the rabbit hole</h2>

<p>We could stop here and you&rsquo;d have a good idea of what the Shadow DOM allows you to do, and how to use an element&rsquo;s shadow root. But we&rsquo;re going to take it one step further. When we created the shadow root you might have asked yourself why there is a method <code>createShadowRoot</code> in the first place. Does it mean you can have multiple shadow root&rsquo;s in an element? It does!</p>

<p>So let&rsquo;s go ahead and create a second shadow root to further our experimentation:</p>

<pre><code class="language-javascript">root2 = c.createShadowRoot();
</code></pre>

<p>This will return a new shadow root. But what you might also notice is that the words &ldquo;Hello Matthew&rdquo; disappeared from the page. What&rsquo;s going on? First use the <strong>Elements</strong> tab and expand your <code>#container</code> div and there should now be two shadow roots. The first is <code>root1</code> and its contents are still there. That&rsquo;s good, but why can&rsquo;t we see it?</p>

<p>The reason is that the browser only renders the <em>last</em> shadow tree. The others are still there, you just can&rsquo;t see them. In your console do this:</p>

<pre><code class="language-javascript">c.shadowRoot == root1
c.shadowRoot == root2
</code></pre>

<p>As you can see, the div&rsquo;s new shadowRoot is now <code>root2</code>. You might be asking how this is useful&hellip; I&rsquo;ll get to an explanation but it might be better to show you. Go ahead and attach that other template to the new root:</p>

<pre><code class="language-javascript">root2.appendChild(document.querySelector('#tmpl2').content);
</code></pre>

<p>Ah! The first shadow&rsquo;s content is back. This is because <code>#tmpl2</code> has an insertion point with <code>&lt;shadow&gt;&lt;/shadow&gt;</code>. This says &ldquo;insert the previous shadow here&rdquo;, more or less. You may also notice that the second template&rsquo;s div is not in red. This is because the <code>&lt;style&gt;</code> tag in the first template is scoped to only content within that template. This is the beauty of templates.</p>

<p>Back to the question, how is multiple shadow trees useful anyways? A big part of web components is going to be extending existing components. Shadow DOM provides an excellent way to do that. Let&rsquo;s say I created <code>&lt;super-calendar&gt;</code> and it was awesome&hellip; but ugly. You might want to come around and create <code>&lt;pretty-calendar&gt;</code> that modified part of the DOM structure a little bit, applied some prettyier scoped <code>&lt;style&gt;</code> but left my JavaScript alone. With <code>&lt;shadow&gt;</code> and <code>select</code> you can do all of that, keeping just the parts of my ugly calendar that are needed to function.</p>

<p>Hopefully this has taught you a little bit about what is possible thanks to Shadow DOM. More important, however, is that you see how easy it is to experiment with emerging web technologies thanks to the awesome developer tools Chrome and Firefox provide us.</p>

<p>Send your thoughts/hacks to <em>matthew@matthewphillips.info</em>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/test-your-application-entry-point.html">
        Test Your Application Entry Point
      </a>
    </h1>

    <span class="post-date">Wed, Mar 26, 2014</span>

    <p>This will be short and sweet. When working on a large JavaScript application (or a small one, for that matter) you&rsquo;re going to have an entry point where you set up your world and get everything started. It probably looks something like this:</p>

<pre><code class="language-javascript">define([
  'xwidget',
  'ywidget',
  'routing'
], function(XWidget, YWidget, route){
  // Load everything!

  // Set up global state!
  var state = {
    light: 'green',
    time: new Date()
  };

  // Initialize main widget!
  var main = new XWidget('body', {
    subwidget: new YWidget($('&lt;div&gt;&lt;/div&gt;'), {}),
    state: state
  });

  // Listen for routes
  route('/calendar', function(){
    // Make some change to `main` probably
  });
});
</code></pre>

<p>It&rsquo;s very easy to forget that not only is this an important chunk of code, it influences everything else that happens further down the chain in your application. <strong>Test it</strong> as though it&rsquo;s just as important, because it is.</p>

<p>When you begin crafting your application as a pyramid of <a href="http://dailyjs.com/2014/03/10/components-controls/">web components</a> this becomes even more critical. Using <a href="http://canjs.com/guides/Components.html">can.Component</a>&rsquo;s scoping rules, data you initialize in your <code>main.js</code> will trickle down and be used by any component on your page, no matter how deeply nested.</p>

<p>This is amazing in terms of crafting components that glue well together, but the downside is that the tests you created for <code>&lt;x-widget&gt;</code> are not enough, that top level file might be doing things just slightly differently.</p>

<p>The benefits of writing tests first hold as well for your application entry point. If you try writing tests after-the-fact (as I&rsquo;m currently doing) you&rsquo;ll notice that things break as your entry point file is actually dependent on something in your <code>index.html</code> file (as an example). Tests first will force you to make sure everything is as maximally modular as can be.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/markdown-enable-your-blog-comments-with-web-components.html">
        Markdown Enable Your Blog Comments with Web Components
      </a>
    </h1>

    <span class="post-date">Sat, Mar 1, 2014</span>

    

<p>If you&rsquo;re like me and are excited about getting started using web components today, you might find yourself struggling coming up with practical uses that aren&rsquo;t the typical carousel, calendar, or <a href="http://matthewphillips.info/posts/building-an-accordion-with-can-component.html">accordion</a> widgets that we&rsquo;ve all written a hundred times in plain JavaScript.</p>

<p>In this article I&rsquo;ll walk you through the process of:</p>

<ul>
<li><p>Finding a practical use for web components.</p></li>

<li><p>Developing your first iteration.</p></li>

<li><p>Refining, deciding when components are needed and when they are just extra fluff.</p></li>
</ul>

<p>All of my examples will use <a href="http://canjs.com/guides/Components.html">can.Component</a> because it&rsquo;s available today, is stable, and has really good browser support, but are still applicable no matter what your web component framework of choice is.</p>

<h1 id="from-concept-to-code:91190a79664036955176de2fc388a61f">From Concept to Code</h1>

<p>If all you&rsquo;re interested in is learning you can pick just about any API on the web and turn it into a web component. Or pick your favorite JavaScript library and wrap a component around it. Web components are primed to be the new jQuery plugin.</p>

<h2 id="markdown:91190a79664036955176de2fc388a61f">Markdown</h2>

<p>If you&rsquo;re a programmer you probably use markdown (or another markup generator) quite often. I&rsquo;m writing this post in markdown right now. The only downside is I have a Grunt task running in the background that is rerendering the html every time I save the file. What if you could write markdown and have it generate all in the browser? You want to write something like:</p>

<pre><code class="language-html">&lt;markdown&gt;
# Hello world!

* Oh my, **lists**
&lt;/markdown&gt;
</code></pre>

<p>And let a library do the heavy lifting. Luckily there is a <a href="https://github.com/coreyti/showdown">Showdown</a>, a JavaScript library for turning markdown into HTML. It&rsquo;s pretty fantastic. So let&rsquo;s make a component.</p>

<p>Since Showdown does most of the heavy lifting all we need is a nice wrapper that will allow us to write Markdown inside of a tag and have it render the HTML automatically. Using can.Component we can do that easily, here&rsquo;s a demo:</p>

<h2 id="demo:91190a79664036955176de2fc388a61f">Demo</h2>

<iframe width="100%" height="300" src="http://jsfiddle.net/TBFp6/3/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

<p>The code should speak for itself. The <code>x-markdown</code> component (all web components should be namespaced, we use <code>x-</code> in this example) generates the HTML after it is inserted into the page. We simply listen for the <code>inserted</code> event and set the <code>&lt;content/&gt;</code> provided by the user to the <code>markdown</code> property on the component&rsquo;s Scope.</p>

<p>The powerful part of this example is the <code>can.compute</code>. Computes are a type of object that can listen to changes of other objects and automatically recompute themselves. If you&rsquo;ve used <a href="http://knockoutjs.com/documentation/observables.html">ko.observable</a> or Ember <a href="http://emberjs.com/guides/object-model/computed-properties/">computed properties</a> the idea is much the same, but can.computes are a bit more powerful (we&rsquo;ll get to that later).</p>

<p>The compute simple takes the value of the <code>markdown</code> property (which is set in the <code>inserted</code> event) and uses Showdown to generate the html that will be displayed.</p>

<h1 id="using-with-blog-comments:91190a79664036955176de2fc388a61f">Using with Blog Comments</h1>

<p>While cool, this example isn&rsquo;t that practical. In reality you&rsquo;ll rarely have a scenario where you need to write HTML inside of a web browser, otherwise using a static site generator is probably what you&rsquo;ll be using.</p>

<p>One place where you would want to generate the HTML on the fly is for blog comments. If your blog is developer-focused it makes sense to allow the reader to write comments in markdown, and have a live preview of what it will look like. So let&rsquo;s refactor <code>&lt;x-markdown&gt;</code> to be our live preview.</p>

<pre><code class="language-javascript">can.Component.extend({
  tag: 'x-markdown',
  template: '&lt;div&gt;{{{html}}}&lt;/div&gt;',
  scope: {
    html: can.compute(function() {
      var markdown = this.attr('markdown');
      var converter = new Showdown.converter();
      var html = converter.makeHtml(markdown);
      return html;
    }),
    markdown: ''
  }
});
</code></pre>

<p>This new version of <code>&lt;x-markdown&gt;</code> is much more succinct because we&rsquo;ve eliminated the <code>&lt;content/&gt;</code> portion by getting the raw markdown from a textarea. can.Component allows you to pass data (included complex objects) through an element&rsquo;s attribute tags. We&rsquo;ll use it like such: <code>&lt;x-markdown markdown=&quot;value&quot;&gt;&lt;/x-markdown&gt;</code> so that the <code>html</code> compute will be live-bound to the <code>value</code> object that we pass in.</p>

<p>Next we need to create a live-bound textarea we&rsquo;ll call <code>&lt;x-textarea&gt;</code>. The idea that both x-markdown and x-textarea will be live-bound to the same compute object, and any time you type into the textarea the markdown will automatically be rerendered in the preview window. Demo time:</p>

<h2 id="demo-1:91190a79664036955176de2fc388a61f">Demo</h2>

<iframe width="100%" height="300" src="http://jsfiddle.net/TBFp6/6/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

<p>Try out the fiddle (Click on the <strong>Result</strong> link) and see for yourself how the preview updates as you type. The secret sauce here is that we are using <code>can-value</code> to bind the textarea&rsquo;s <code>value</code> to our scope property also called <code>value</code>. can-value works on the element&rsquo;s <code>change</code> event, which for most types of forms is fine, but in our case we need the preview to update as you type, so we&rsquo;ve added a <code>keyup</code> event that simply triggers the textarea&rsquo;s change event as the user types. Simple!</p>

<h1 id="when-not-to-web-component:91190a79664036955176de2fc388a61f">When not to Web Component</h1>

<p>Awesome, we&rsquo;ve built a live-bound markdown enabled comment system. In less than 30 lines of code. However you might notice that the <code>&lt;x-textarea&gt;</code> isn&rsquo;t really doing much at all. It simply turns a normal textarea into a live-bound one.</p>

<p>However in reality textareas <em>really are</em> live-bound, they use the normal DOM events to update their values. So all we are using the <code>&lt;x-textarea&gt;</code> for in practice is to turn the DOM events into can events. Luckily <a href="http://canjs.com/docs/can.compute.html">can.compute</a> already has a way of doing this, so we don&rsquo;t need the <code>x-textarea</code> at all.</p>

<p>can.compute can take a set of arguments that includes an element, the property to bind to, and an event to bind to. We&rsquo;ll use it like:</p>

<pre><code class="language-javascript">var markdown = can.compute(textarea, 'value', 'keyup');
</code></pre>

<p>This allows us to move our textarea outside of the script tag (since we&rsquo;re getting rid of the component) but still have a live-bound value between the textarea and our <code>x-markdown</code> preview. See the demo below.</p>

<h2 id="demo-2:91190a79664036955176de2fc388a61f">Demo</h2>

<iframe width="100%" height="300" src="http://jsfiddle.net/TBFp6/5/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

<p>Hopefully I&rsquo;ve demonstrated the process of coming up with an idea for a component (essentially an encapsulated piece of HTML with JavaScript interactivity) and refining it until you are left with only the bits of code that you need. We&rsquo;ve created a Markdown-enabled blog commenting system is only 18 lines of code. Let it be inspiration for your next component. Can you do better, how about an MDN reference widget?</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/building-an-accordion-with-can-component.html">
        Building an accordion with can.Component
      </a>
    </h1>

    <span class="post-date">Mon, Dec 2, 2013</span>

    

<p>I learn best by doing, so in an effort to learn more about <a href="http://canjs.com/guides/Components.html">can.Component</a> I&rsquo;ve been creating common types of components using the new framework. An <strong>accordion</strong> is one such example and I wanted to write about my experience creating the component. Note that this article doesn&rsquo;t constitute a best practice, I&rsquo;ve only been using can.Component for a few weeks now. Nor is the goal here for the least amount of code (My first couple of iterations used less code actually), rather I wanted to write the component as DRY as possible.</p>

<p>I&rsquo;ve long been a fan of the <a href="http://www.w3.org/TR/components-intro/">Web Components</a> and was excited at the idea that <a href="http://canjs.com/index.html">can</a> could make it possible to write components today. Components are much different than traditional MVC-style programming, in that much more of your code is spent expressing what a component is rather than listening for DOM events and reacting. To that purpose, when I set out to create an accordion control I started with what I wanted it to look like in the end.</p>

<p>An accordion is made up of a list of elements, each with a header and content, that when the header is clicked the content collapses and only the header is shown. So in the end, our html should look something like:</p>

<pre><code class="language-html">&lt;accordion&gt;
  &lt;collapsible&gt;...&lt;/collapsible&gt;
  &lt;collapsible&gt;...&lt;/collapsible&gt;
  &lt;collapsible&gt;...&lt;/collapsible&gt;
&lt;/accordion&gt;
</code></pre>

<p>Note that we actually have 2 components here. It&rsquo;s important that the <code>collapsible</code> component operate independently of being hosted inside of an <code>accordion</code>. This leads to DRYer code, a <code>collapsible</code> component is something that can be useful in a lot of places.</p>

<h2 id="collapsible:6d66696e91dedbd4096c7a5698258b38">Collapsible</h2>

<p>So first to build our <code>collapsible</code> component. Like I said before, a <code>collapsible</code> has a header containing a title, and it has a content section. It should look something like:</p>

<pre><code class="language-html">&lt;collapsible class=&quot;open&quot;&gt;
  &lt;header&gt;
    &lt;h1&gt;This is a title&lt;/h1&gt;
  &lt;/header&gt;
  &lt;article&gt;This is content.&lt;/article&gt;
&lt;/collapsible&gt;
</code></pre>

<p>Note that the collapsible contains a class called <code>open</code>. This will be used with CSS to control the <code>article</code>&rsquo;s height. If the collapsible is not open we&rsquo;ll hide it by setting its height to <code>0px</code> and overflow to <code>none</code>. Now to the code for this component:</p>

<pre><code class="language-javascript">can.Component.extend({
  tag: 'collapsible',
  template: '&lt;header can-click=&quot;toggle&quot;&gt;&lt;h1&gt;{{item.title}}&lt;/h1&gt;&lt;/header&gt;' +
    '&lt;article&gt;{{item.content}}&lt;/article&gt;',
  scope: {
    item: new can.Map({}),
    toggle: function(){
      this.attr('item.open', !this.attr('item.open'));
    }
  },
  events: {
    '{item} open': function(context, ev, newVal){
      this.element[newVal ? 'addClass' : 'removeClass']('open');
    }
  }
});
</code></pre>

<p>It&rsquo;s pretty straight forward. The <code>can-click=&quot;toggle&quot;</code> attribute tells can that when the header is clicked, call the <code>toggle</code> function, which is part of the component&rsquo;s scope. The <code>toggle</code> function simple toggle the <code>item</code>&rsquo;s <code>open</code> flag. Then we have an event that listens for the changes to <code>open</code> and sets the element&rsquo;s class appropriately. Note that I could have placed the <code>open</code> class as part of the <code>&lt;article&gt;</code> element. The advantage to doing it that way is that it could have been included in the template which would have avoided the entire events section of the code. Ultimately I decided that it was more <em>correct</em> to have the <code>collapsible</code> itself be either open or not. Either approach is valid. The CSS is straight forward, but if you&rsquo;re a better designer than I you might use transforms or transitions.</p>

<pre><code class="language-css">collapsible article {
  overflow: hidden;
  height; 0px;
}

collapsible.open article {
  height: auto;
}
</code></pre>

<p>You can try this on your own, using this simple component you have a collapsible header/content panel.</p>

<h2 id="accordion:6d66696e91dedbd4096c7a5698258b38">Accordion</h2>

<p>An accordion simple wraps a number of <code>collapsible</code>s and has 1 extra feature: it ensures that only 1 collapsible is open at a time. So in order to create my accordion I really only need a couple of things:</p>

<ol>
<li>A way to listen for when a collapsible&rsquo;s <code>open</code> property changes.</li>
<li>A way to determine which items need to be set to closed.</li>
</ol>

<p>Below is the code that creates our accordion, take a look first and then I&rsquo;ll step you through what is happening.</p>

<pre><code class="language-javascript">can.Component.extend({
  tag: 'accordion',
  template: '{{#each items}}&lt;collapsible item=&quot;items.{{@index}}&quot;&gt;' +
    '&lt;/collapsible&gt;{{/each}}',
  scope: {
    items: new can.List([]).
    selected: '@',
    select: function(index){
      var items = this.attr('items');
      for(var i = 0; i &lt; items.attr('length'); i++) {
        var isOpen = i === index;
        items[i].attr('open', isOpen);
      }
    }
  },
  events: {
    'inserted': function(){
      var selected = +(this.scope.attr('selected') || 0);
      this.scope.select(selected);
    },
    '{items} change': function(list, ev, what, how, newVal){
      if(~what.indexOf('open') &amp;&amp; newVal) {
        var which = +what.substr(0, what.indexOf('.'));
        this.scope.select(which);
      }
    }
  }
});
</code></pre>

<p>The first thing you&rsquo;re likely to notice is that we&rsquo;re attaching this to the collapsible: <code>item=&quot;items.{{@index}}&quot;</code>. We are doing this because the way you pass data to a child component is through its attributes. The attribute&rsquo;s name is the name of the property on the component&rsquo;s scope that we want to set, in this case <code>item</code>. The attribute value is the name of the parent scope&rsquo;s property that we want to pass in, in this case <code>item.0</code> (or <code>item.1</code>, etc. <code>{{@index}}</code> gets the index inside of our each loop).</p>

<p>Since the <code>collapsible</code> controls its own <code>open</code> state we only need to observe changes that happen to our children items. This is what is happening in the <code>{items} change</code> event. Any time something changes to one of our items we check to see if it is an open event, and if so we run the scope&rsquo;s <code>select</code> method which takes the index of the item that is selected and marks all others as closed (by changing their <code>close</code> property, which automatically prompts an event in the <code>collapsible</code> component which is what actually removes the class.</p>

<p>And that&rsquo;s pretty much all there is to an accordion. One other thing you might be unaware of is why the scope has a <code>selected</code> property with a value of <code>@</code>. This means that we want to use the value of the attribute rather than an object it refers to. We use this so that you can pass in the default collapsible to open like so: <code>&lt;accordion selected=&quot;2&quot;&gt;&lt;/accordion&gt;</code> means that the <code>collapsible</code> with an index of 2 will be open and all others closed.</p>

<h2 id="summary:6d66696e91dedbd4096c7a5698258b38">Summary</h2>

<p>As you can see, creating reusable components with can.Component is fairly straight forward. It&rsquo;s just a matter of rethinking how you design a component, to be more declarative. I&rsquo;m hopeful that designing this way will make it more natural to create smaller, more modular components. Your application itself should be merely a declaration of componenents and bindings of data between them.</p>

<h2 id="demo:6d66696e91dedbd4096c7a5698258b38">Demo</h2>

<iframe width="100%" height="300" src="http://jsfiddle.net/a6r3c/6/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/functional-javascript-in-action.html">
        Functional JavaScript in action
      </a>
    </h1>

    <span class="post-date">Thu, Nov 28, 2013</span>

    <p>Recently came across a <a href="http://redactweb.com/javascript-to-convert-between-states-and-abbreviations/">blog post</a> about a JavaScript function to convert state names to abbreviations (or vice versa) and realized that it&rsquo;s an excellent topic to present the power that can be had from functional programming in JavaScript.</p>

<p>The premise of the article is that the author needed a function that when given a state name or abbreviation would return the opposite. The author went about it by first finding a PHP function that does the same, then simply converted the code over to JavaScript. While this method surely works for the purpose needed, it also illustrates how powerful functional programming techniques could be used instead which will produce the same result, but also have some reusable code.</p>

<p>First, let&rsquo;s rewrite the function to get rid of the looping pattern. To do this in a more functional way we can break down what is happening into a few steps. The function is provided two arguments: <code>name</code> and <code>to</code>. Name is the value that we are looking up in our array and to is the key that we want to convert to. Given that, in order to find the value we need to know the name of the key of that value. It&rsquo;s the opposite of <code>to</code>, right? Using the power of Underscore/Lodash &ndash; I prefer <a href="http://lodash.com/docs">Lo-Dash</a> &ndash; this can be done using the <code>_.without</code> function. Now, keep in mind that for performance it would probably be better to find the <code>from</code> value using a ternary expression, but for the sake of the article we want to do it in a functional way. So that makes our first expression:</p>

<pre><code class="language-javascript">var from = _.without(['name', 'abbrev'], to)[0];
</code></pre>

<p>What this does is simply take the array, find the value that matches <code>to</code> and remove it, leaving only one string which is our <code>from</code> key.</p>

<p>Now that we know what our <code>from</code> key is, we need to look up the <code>name</code> in our states array. But before we do that let&rsquo;s see how the original blog post is doing the lookup:</p>

<pre><code class="language-javascript">$.each(states, function(index, value){
  if (to == 'name') {
    if (value.abbrev.toLowerCase() == name.toLowerCase()){
      returnthis = value.name;
      return false;
    }
  } else if (to == 'abbrev') {
    if (value.name.toLowerCase() == name.toLowerCase()){
      returnthis = value.abbrev.toUpperCase();
      return false;
    }
  }
});
</code></pre>

<p>Simple enough, they are looping over their <code>states</code> array and finding the value that matches what they want to convert. If they are converting to <code>name</code>, then they are comparing against the <code>abbrev</code>, and they are converting to <code>abbrev</code> they are comparing to <code>name</code>. When they find the match they assign it to their <code>returnthis</code> variable and then returning false, which will existing the loop in <code>$.each</code>.</p>

<p>We can do better. Since we&rsquo;ve already gotten the <code>from</code> key, we can skip the repetitive if/else block that does the same thing. And instead of using an <code>each</code> loop let&rsquo;s use the power of functional programming to <code>_.find</code> that value.</p>

<p>First, let&rsquo;s construct a regular expression that we can test against values, to prevent the <code>toLowerCase</code> conversion they are doing.</p>

<pre><code class="language-javascript">var exp = new RegExp('^' + name + '$', 'i');
</code></pre>

<p>This simply creates a regular expression that matches for the <code>name</code>, ignoring case. Now let&rsquo;s find the object that matches the value in our <code>from</code> key:</p>

<pre><code class="language-javascript">var selected = _.find(states, function(st){
  return exp.test(st[from]);
});
</code></pre>

<p>Perfect, this will find the object we are looking for (<code>RegExp.prototype.test</code> returns true on a match) and we only need to return the <code>to</code> key. Full source:</p>

<pre><code class="language-javascript">function convertState(name, to) {
  var from = _.without(['name', 'abbrev'], to)[0];
  var exp = new RegExp('^' + name + '$', 'i');
   
  var selected = _.find(states, function(st) {
    return exp.test(st[from]);
  });
   
  return selected[to];
}
</code></pre>

<p>But wait, we&rsquo;ve uncovered a pattern here. This is where functional programming becomes most useful. When you write a bit of code, note that there&rsquo;s a pattern, and abstract out that pattern so that you can reuse the code whenever the pattern is discovered. In our case, what are we really doing? We&rsquo;re operating on an array of objects, each containing 2 keys. We look up the value from one key and return the other. Simple, right?</p>

<p>So what we can and should do is create a function that does all of this for you automatically. It returns a functional that operates on that set of rules using the array you provide it. First we need to replace this line:</p>

<pre><code class="language-javascript">var from = _.without(['name', 'abbrev'], to)[0];
</code></pre>

<p>To get rid of the hard coded string array. Instead we want to pass in our &ldquo;array of objects&rdquo; and have the function find the fields. We can do that like so:</p>

<pre><code class="language-javascript">var fields = _.keys(array[0]);
</code></pre>

<p>And then we simply need to return a function that takes <code>name</code> (for value lookup) and <code>to</code> arguments. With that we&rsquo;ve created a <strong><em>higher order function</em></strong> that makes it easy any time we have a situation with the same pattern. Full source and examples below.</p>

<pre><code class="language-javascript">function makeSwappable(array) {
  var fields = _.keys(array[0]);
  return function(name, to) {
    var from = _.without(fields, to)[0];
    var exp = new RegExp('^' + name + '$', 'i');
     
    var selected = _.find(array, function(item) {
      return exp.test(item[from]);
    });
     
    return selected[to];
  };
}
 
var convertState = makeSwappable(states);

convertState('Kentucky', 'abbrev'); // -&gt; 'KY'
convertState('CA', 'name'); // -&gt; 'California'
</code></pre>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/beware-the-creeper.html">
        Beware the Creeper
      </a>
    </h1>

    <span class="post-date">Tue, Sep 17, 2013</span>

    <p><em>By Jason Hall</em></p>

<p><em>Art by Cliff Chiang</em></p>

<p>I have an affinity for The Creeper which dates back to Steve Niles&rsquo; brief run. Niles&rsquo; <em>30 Days of Night</em> series was one of the books that got me into comics. So given that, and the fabulous cover to the graphic novel, the chances of me not liking this book were close to zero. No need to worry though, my bias cannot be blamed for this one, as this has to be the definitive Creeper story ever told. Hall&rsquo;s convinced me that Creeper is a character that belongs in 1925 Paris and that will color all interpretations that I read going forward.</p>

<p>It&rsquo;s interesting that this is the case, because about half way through the book it became apparent to me that Jason Hall really just wanted to write about the surrealism and the bohemian movement in France during the early 20th century. I&rsquo;m rather glad that he found the excuse because with the few short acts of <strong>Beware the Creeper</strong> he was able to craft together a world that really feels lived in. That he managed to throw in a classic DC villain into the mix without making it feel the slightest bit ridiculous is commendable. In fact I wonder if this book was concepted around The Creeper or if The Creeper was only selected after Hall had decided that he wanted to do a book about French surrealism.</p>

<p>Structurally the book is not breaking any new territory. In the first act we are introduced to the characters, ending in Judith Benoir&rsquo;s rape and (seemingly) transformation into The Creeper. Act two is the escalation and what happens to Paris as a result of The Creeper coming on to the scene. At first they openly embrace him/her as she/he seems to represent the surrealist rejection of the ordinary. By the end of the second act, however, the feeling is that The Creeper has gone too far (having been accused of a couple of murders) and so we see that despite their embellishments the people of Paris have some, frankly, normal values as well. Act three is where we find out that things are not what they seem; I&rsquo;ll not spoil that particular reveal but instead just say that the hints are all over the book and not something you&rsquo;ll have trouble putting together yourself.</p>

<p>I always question trickery of the sort in a non-detective book. The questions I ask is if the twist is necessary and if it detracts from the themes of the book. Examining this I have to wonder what it is that the twist is supposed to reveal. Something about Paris or about the characters? For it&rsquo;s many strengths, <strong>Beware the Creeper</strong> is not particularly a character piece. Aside from that of the Creeper&rsquo;s secret identity, the rest are fairly ordinary characters who could have been plucked from any other story written in a similar structure. The characters are not the focal point and that&rsquo;s why I think it works. The Creeper is not a product of events that occurred as much as he/she is a product of surrealism itself. That someone can go inside is nothing novel; that they go insane and turn into&hellip; this, well that can only happen in the setting in which this lives.</p>

<p>Ultimately that&rsquo;s why this book is so successful. Hall has recreated Paris 1925 in a way that we all feel we are there ourselves. The story is merely an excuse to visit this world for an hour (or so). Here&rsquo;s hoping Hall allows us to revisit this world some day.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/batman-the-long-halloween.html">
        Batman: The Long Halloween
      </a>
    </h1>

    <span class="post-date">Thu, Aug 29, 2013</span>

    <p><em>By Jeph Loeb</em></p>

<p>By the time I flipped to the last page of The Long Halloween I had already decided that it was one of the best detective stories I had ever read. I had concluded that, in fact, it should be read in literature classes. Even after a couple of weeks to sit on it I can&rsquo;t really back down from either of those statements. If any medium needs a signature piece, a piece to illustrate what makes the medium worthwhile, comics do, and Batman The Long Halloween could be that. This sounds hyperbolic, I know, and I do not mean to say that The Long Halloween is the best the medium has to offer; rather I am saying that it follows a familiar genre; one known in practically all fictional mediums, and it does so as well as the best of any other. And because of that it serves an exemplary comic book. That when you have a story as entralling as this, with art that perfectly complements it, you cannot put it down.</p>

<p>At it&rsquo;s core Batman The Long Halloween is a three act detective story. In the first act there is the setup. Batman, who needs little introduction. The crime families of Gotham; The Falcones and the Maronis. Harvey Dent, district attourney. Catwoman. The commissioner, Jim Gordon. The second act comes quickly, as members of the crime families begin to be picked off. The third act comes unexpectedly at the end of the book, throwing a curveball at the reader.</p>

<p>The pace of the book is relentless. Each issue (except for a couple) revolves around a holiday and after the first couple the reader realizes that there will be a murder in each. This creates a rather intense sort of anxiety in the reader, who knows a murder is coming within only a handful of pages. If I were to criticize the pacing at all it is that the pacing, which no doubt was done to fit with the theme of each issue representing a separate holiday, makes it more difficult to appreciate Batman as a detective. There aren&rsquo;t enough pages to contain both the movement of the plot forward, the profoundly interesting supporting case, and Batman making progress on the case.</p>

<p>I&rsquo;m not sure that it matters, however, as this is a whodunnit where you don&rsquo;t care so much about whodunnit. That might be the least interesting part about The Long Halloween. What makes this a defining piece of comic book literature is the world building done by Loeb right from the beginning. From the beginning it feels like you are dropped into Godfather, except with tights and psychotic characters. And at the same time it&rsquo;s as noir as a comic book gets. That Loeb was able to pull those three genres together; noir, gangster, and superhero, together into a seemless, liveable, world is particularly amazing. It&rsquo;s the thing that keeps you glued from the beginning to the end.</p>

<p>As great as the book is, it&rsquo;s not quite perfect. There are elements that didn&rsquo;t have me on the edge of my seat. For example, although the crime family drama was interesting, I can&rsquo;t point to any of the characters that I found particularly interesting on their own. In fact, I can&rsquo;t really remember much about the characters at all. This doesn&rsquo;t, I don&rsquo;t think, point to any weakness of the characters, but probably rather that I&rsquo;m just not that big of a fan of the crime family genre. For many this won&rsquo;t be an issue, but for me it meant I had to keep notes in order to keep track of what was going on, and who might be Holiday.</p>

<p>I&rsquo;ve read many who think that Tim Sale&rsquo;s artwork in this book is an example of a book that thrives despite subpar art, but I couldn&rsquo;t disagree more. There is definitely a lack of symmetry in the art, but I don&rsquo;t consider that to be a weakness at all. It is fitting with the gritty narrative. A polished looking character doesn&rsquo;t belong in the world Loeb has created here. There still is an incredible amount of detail in the art. It&rsquo;s just a little crooked, that&rsquo;s all.</p>

<p>Being one of the only Batman classics I&rsquo;ve read, I don&rsquo;t have the perspective to talk about Harvey Dent&rsquo;s transformation in the light of the history of the character. So I have to approach it as though it is his origin story (although I know that it is not). But from that perspective it&rsquo;s still a fascinating look at a character who breaks down at the weight of events that surround him. Harvey is part of the triumvirate of Batman, Gordon, and himself. He feels the pressure to live up to his peers, and at the same time he is the public face for what is happening in Gotham. He feels a religious need to bring order to a city that has lost it. And it is that pressure that, or so we are led to believe, causes him to snap and become Holiday. The truth, as we find out, is that Harvey isn&rsquo;t Holiday. Or at least, he&rsquo;s not Holiday all on his own. He also had his wife paying a role as well.</p>

<p>I have trouble coming to terms with his wife as being in on the act. We are not given a reason for her to become a killer. It feels, rather, that Loeb wanted a good twist and this provided one. Dent was a suspect from the early chapters and it would be too easy to have him be the lone perpetrator. Never the less, these are all minor quibbles. The book succeeds due to it&rsquo;s amazing pacing, wide and layered cast, and world building. As a representative of the best of comic books it would make great learning material in schools, and as a comic fan it&rsquo;s something you are missing out on if you haven&rsquo;t read.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/state-of-developing-on-a-chromebook.html">
        State of Developing on a Chromebook
      </a>
    </h1>

    <span class="post-date">Thu, Aug 29, 2013</span>

    

<p>I&rsquo;ve been developing on a Chromebook for quite a while so I feel I have a pretty good grasp on the strengths and weaknesses as they exist today. The tldr; is that, yes, you can develop on Chromebook and depending on what you consider to be &ldquo;developing on a Chromebook&rdquo; the experience can either be on-par with other computers or a tad&hellip; funky.</p>

<p>To start, I want to clearly define what it means to &ldquo;develop on a Chromebook&rdquo; because it&rsquo;s important to the conversation. There are 4 routes that you can go. I won&rsquo;t spend a lot of time on the first 3 as they are obvious and less interesting to discuss, but the 4th is where the meat of this post belongs. Without further ado the four methods are:</p>

<h2 id="crouton-https-github-com-dnschneid-crouton:911d10bbf97485beabbee5a9040c69e4"><strong><a href="https://github.com/dnschneid/crouton">Crouton</a></strong></h2>

<p>This gives you a chroot environment with which you can install Ubuntu and do whatever you want. Some people really like doing this. Which is fine, but at this point you&rsquo;re not really using ChromeOS to develop on, even if you do dual-boot.</p>

<h2 id="ssh:911d10bbf97485beabbee5a9040c69e4"><strong>SSH</strong></h2>

<p>Using <a href="https://chrome.google.com/webstore/detail/secure-shell/pnhechapfaindjhompbnflcldabbghjo?hl=en">Secure Shell</a>, a Native Client enabled SSH client, you can login into a remote computer and work using usual command-line tools like Tmux and Vim. This is currently the primary way I code on a Chromebook. While it works rather well, it&rsquo;s not always ideal as, for example, it&rsquo;s difficult to develop Chrome packaged apps this way. Getting the <code>crx</code> file from your server to your Chromebook is tricky.</p>

<p>The best way to work this way is to use <a href="http://www.lbreda.com/grive/start">Grive</a>, a Google Drive sync client for Linux. Once you&rsquo;ve created the <code>crx</code> simply copy it to a folder in Drive. From there you can open the file in Chrome&rsquo;s File Manager and it will prompt to be installed. Still, this is a slow process, as the file has to be uploaded to Drive, then downloaded back down from Drive on the Chromebook and installed.</p>

<p>But for certain types of programmers, particularly system programmers, who are always programming from an ssh session anyways, this works out as well as any other computer. Perhaps even better, Secure Shell is a very slick &ldquo;terminal emulator&rdquo; (for the lack of a better term).</p>

<h2 id="web-ide:911d10bbf97485beabbee5a9040c69e4">Web IDE</h2>

<p>This is the first <em>real</em> way to program on a Chromebook. For a lot of people this works nicely. There are a lot of choices out there, two that stand out are <a href="https://c9.io/">Cloud9</a> and <a href="https://www.nitrous.io">Nitrous.io</a>. I have used Cloud9 a bit and it works rather nicely. For people who are used to using desktop IDE&rsquo;s like Eclipse then this might work well for you. My only complaint is that when you use a SaaS client you kind of have to use it for everything. That&rsquo;s just not my style though. I prefer a seperate application for each task, that way I can swap out the pieces I don&rsquo;t like. With a Web IDE if you don&rsquo;t like any one piece your own recourse is to switch to an entirely different IDE.</p>

<h2 id="working-locally:911d10bbf97485beabbee5a9040c69e4">Working locally</h2>

<p>Which brings me to the last way to work, the most interesting way to work, and the most frustrating way to work on a Chromebook. Despite the complaints that are to follow I want to make it clear that the future looks bright for this category. There are many applications and APIs under development (as I&rsquo;ll discuss) that are going to dramatically improve the experience of developing locally on a Chromebook.</p>

<p>Since packaged apps are still in their young days there aren&rsquo;t a million options for text editors, but there are already a few. The best of which is probably Google&rsquo;s own <a href="https://chrome.google.com/webstore/detail/text/mmfbcljfglbokpmkimbfghdkjmjhdgbg?hl=en">Text</a> (of which I&rsquo;m an inactive contributor). It&rsquo;s not great, but it&rsquo;s just fine for the earlier stages of things.</p>

<p>However, you run into trouble when you start thinking about workflow. This is the area that Chrome needs to round out with better APIs. Let&rsquo;s say you are starting a new project on your Chromebook, where do you store it? Well, on many Chromebooks there is little hard drive space so having a lot of development projects on it might be a bad idea (my Chromebook considers it&rsquo;s entire hard drive to be a &ldquo;Downloads&rdquo; folder, indicating that it is intended for temporary storage only). The alternative is to use Google Drive, which is probably the best option for now. You can even mark files as available offline in Drive and not have to worry about losing an internet connection.</p>

<p>This is still not quite ideal, though. Drive is limited, you have to manage how much stuff you keep there. And perhaps your work uses Dropbox. There is no way to use Dropbox (besides the web app) on a Chromebook. This is why I&rsquo;ve long wanted an API for filesystems, so that WebDAV or Dropbox or whatever can live right beside Google Drive in the File Manager and file picker menus. Luckily there has been some movement on this issue lately with some Googlers <a href="https://docs.google.com/document/d/1VkaRYDP3RMESygl6Po0ajimXqijejZNF2p9rCszYEew/edit">discussing the idea</a>. It&rsquo;s not evidence that it will be coming soon, it&rsquo;s just a positive sign that they are thinking about the same things.</p>

<p>Even if you are able to develop locally how do you share that code? How do you use source control? This is one area where things look positive. The developer Tim Caswell has been working on <a href="https://github.com/creationix/js-git">js-git</a>, a reimplementation of <code>git</code> in JavaScript (including the use of Chrome socket APIs) for the past few months. Although still in early stages I can see this project becoming very usable in the near term.</p>

<p>Suddenly the workflow starts to look a bit nicer. Imagine have a Git web-app (powered by <code>js-git</code>) that manages a git repo, then doing developing with Text or another editor, then going back to the git app to commit and push. What would be even better is if a git repo could become a &ldquo;filesystem&rdquo; that sits in the filepicker. That way it could be always connected (perhaps a save operation prompted a commit) and therefore always up to date in the cloud.</p>

<p>This just leaves out one area of a developer&rsquo;s workflow; testing. If you&rsquo;re developing for the browser you&rsquo;re in luck ;) There&rsquo;s a nice one sitting in front of your face. For everyone else&hellip; perhaps a Chromebook isn&rsquo;t what you need. Still, it might be possible in the future to compile a small linux environment like busy box down to a JavaScript blob and even install things like Python on it. I&rsquo;m getting a bit a head of myself, and those things would (likely) never be very fast, but it&rsquo;s something we can see happening. Certainly languages that compile to JavaScript are already flourishing, and most have the ability to compile within a browser, so as long as you are using browser APIs you&rsquo;re set.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/using-cloud-drives-on-chromebooks.html">
        Using Cloud Drives on Chromebooks
      </a>
    </h1>

    <span class="post-date">Mon, Aug 26, 2013</span>

    

<p>tldr; you can&rsquo;t. However what you can do is use an old computer to sync between Google Drive and your other cloud drives, providing (close to) the same effect. I set up a Raspberry Pi, which was previously setting in my basement looking pretty and acting as a Cloud Print server but nothing else, as a WebDAV server which has worked out rather nicely. The one downside is that Chromebooks only support Google Drive as a cloud drive service.</p>

<p>It&rsquo;s rather nice how well Drive is integrated into ChromeOS. And eventually, hopefully, they&rsquo;ll open up an API that allows other cloud services to have similar integration. That would really change the way you think about ChromeOS, pulling it a few steps closer to &ldquo;real computer&rdquo; territory.</p>

<p>Alas that&rsquo;s not the case today, but what you can do is take an old computer, or raspberry pi, and have it act as a synchronization server between your services. This will work with Dropbox, SkyDrive, Ubuntu One, or any provider that supports WebDAV.</p>

<h1 id="syncing-google-drive-to-your-server:55c0cb67e60b298358e0a5730bf39d71">Syncing Google Drive to your server</h1>

<p>I won&rsquo;t get into how to set up your other cloud services to sync, most either have first or third party clients that are easy enough to set up. As is the case with Google Drive. First there is the proprietary app <a href="https://www.insynchq.com/">Insync</a> that works pretty well and has added features such as multiple account support. If your needs are simpler then <a href="http://www.lbreda.com/grive/start">Grive</a> should do the trick, and it is what I use.</p>

<p>On a Raspberry Pi setting everything up was somewhat complicated as it requires several dev packages (strangely including QT4). <a href="http://www.stuffaboutcode.com/2013/03/raspberry-pi-google-drive-grive.html">This guide</a> does a good job of walking you through the process, although I had to apply the fix shown in <a href="https://github.com/Grive/grive/issues/168">this issue</a> to get it to finally compile.</p>

<p>Once install <code>grive</code> is still a little strange to use. It requires that its binary be stored in the root of Google Drive, and it must be run from within that directory. So just remember that when you want to sync Drive to do <code>cd ~/googledrive &amp;&amp; ./grive</code> or just create a script that does that for you.</p>

<p>Since <code>grive</code> only syncs when you run it you&rsquo;ll want to set up a cron job to do it periodically. Type <code>crontab -e</code> and do something like this:</p>

<pre><code>*/5 * * * * ~/update-grive.sh &gt;&gt; ~/log/grive.log
</code></pre>

<p>This tells cron to run the script every 5 minutes. Doing it a little more often probably isn&rsquo;t a problem, I&rsquo;m just being conservative for now.</p>

<h1 id="syncing-with-other-cloud-provider:55c0cb67e60b298358e0a5730bf39d71">Syncing with other cloud provider</h1>

<p>First a word of warning; anything you choose to sync with Drive will exist in Drive; meaning it will count against your storage. For this reason I only sync text files. But it&rsquo;s your storage, do with it what you want.</p>

<p>Once you&rsquo;ve set up sync with your other cloud provider you should have a folder on your server with it&rsquo;s contents. It would be nice if a simple symlink did the trick, but alas grive won&rsquo;t sync down changes from Drive that propogate to the symlink&rsquo;s destination.</p>

<p>Instead I&rsquo;d recommend the handly utility <a href="http://www.cis.upenn.edu/~bcpierce/unison/">Unison</a> for two-way sync. So any changes you make to one drive will be merged over into the other. I&rsquo;m not sure how it handles conflicts, but more than likely you won&rsquo;t be editing the same file in two different services at the same time anyways.</p>

<p>Once you&rsquo;ve installed Unison you&rsquo;ll want to go through the process of running it through the ui the first time:</p>

<pre><code>unison ~/webdav/reviews ~/googledrive/webdav_stuff
</code></pre>

<p>Remember that there is no source and destination here so it doesn&rsquo;t matter which you list first. After the first synchronization you&rsquo;ll want to run unison silently so that it doesn&rsquo;t prompt you for instructions. You can achieve this with the <code>-batch</code> flag:</p>

<pre><code>unison -batch ~/webdav/reviews ~/googledrive/webdav_stuff
</code></pre>

<p>Add this to cron the same way you did previously with grive:</p>

<pre><code>*/5 * * * * ~/sync-folders.sh &gt;&gt; ~/log/unison.log
</code></pre>

<p>And that&rsquo;s it! From now on you can work on your files no matter what computer you&rsquo;re on. When I&rsquo;m on a traditional PC I edit files on my WebDAV drive, and when on a Chromebook I use Google Drive (which is how I&rsquo;m writing this article now).</p>

<h2 id="conclusion:55c0cb67e60b298358e0a5730bf39d71">Conclusion</h2>

<p>The recent updates to Chromebooks and the new packaged apps 2.0 is opening a lot of the possibilities to the platform. Additionally it is showing some of the warts, such as the inability to work on files from <em>other</em> sources. Although I think these holes will eventually be filled, in the mean time we need to do workarounds such as this in order to work the way we want to work. I plan on writing about more of these tricks as I use the platform.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="https://matthewphillips.info/posts/catwoman-volume-2-no-easy-way-down.html">
        Catwoman Volume 2: No Easy Way Down
      </a>
    </h1>

    <span class="post-date">Sun, Aug 4, 2013</span>

    

<p><em>By Ed Brubaker</em></p>

<p>I originally picked up this trade on a whim, seeing it on the shelf at my LCS. I have long liked the Catwoman character, but in all the times when I tried out her ongoing I usually found it to be wanting. I suppose I had written off the series as being too low-priority for DC. Boy was I wrong. Had I known how fantastic this series would be I would have probably picked up the first trade before going for volume 2. Not to worry, I now have that one as well.</p>

<p>Brubaker has a much different take on the character than anything I&rsquo;ve read or seen before. Your typical Catwoman is that of clever thief with a heart-of-gold who you can never quite trust completely. It&rsquo;s that characteristic, that she&rsquo;s going to screw you in the end, that has followed the character around. For me at least it&rsquo;s gotten a little stale; and because of that I can understand why some people feel like Catwoman isn&rsquo;t a character that much can be done with. Lucky Brubaker puts that opinion to rest for good. This is a different Catwoman. There is no heart-of-gold here, she&rsquo;s a geniunely good person who has a certain perspective that allows her to do bad things to people of a certain affluence and power. But to her peeps, those who grew up on the street like her, she&rsquo;s somewhat of a Robin Hood figure.</p>

<p>In this series we see a half-reformed Catwoman. One who has turned to a life of charity and giving back to the place that made her who she is. But she always has one foot back in the life of anti-heroism, as she seeks to protect her neighborhood. That&rsquo;s what makes the dynamic of this book so intriguing. We know that she&rsquo;s going to remain Catwoman yet the woman that we see as Selina Kyle isn&rsquo;t capable of becoming an out-and-out criminal. So she has to tip-toe the line. She is a vigilante, but a respectable one.</p>

<h2 id="black-mask:40f7a85e8bc1401d841f5a423186f406">Black Mask</h2>

<p>This is the first time I&rsquo;ve read a <strong>Black Mask</strong> story, not being aware of the character at all before picking up this trade. First thought was that he looks almost exactly like Red Skull, one of Captain America&rsquo;s rogues, but the internet seems to suggest the characters aren&rsquo;t much related aside from their looks. Black Mask is a crime boss, and that&rsquo;s the gist of what I know about the character.</p>

<p>Unfortunately this series doesn&rsquo;t get too much into his background or motivation. In one of the very last issues of the trade we get a little back story about what happened to him. It&rsquo;s a creepy vignette about being tortured and how surviving it led him to embrace the mask and see torture as an art form.</p>

<p>Not to worry though, this story is about Catwoman and how her past follows her into her present. Selina finds that a childhood friend, Sylvia Sinclair, has made her way back to Gotham, seemingly helping kids stay out of trouble. Later we found out that she is working for Black Mask; being used actually because she is one of the only people that know the true identity of Catwoman.</p>

<p>Catwoman is getting in Black Mask&rsquo;s way, it&rsquo;s as simple as that. However, it&rsquo;s an interesting exploration into how Catwoman deals with the fact that her past causes hardship in her present, and how it affects those around her. Selina&rsquo;s sister is badly traumatized in this storyline (her husband is tortured and murdered) and that follows the rest of the trade.</p>

<h2 id="selina-and-holly-road-trip-it:40f7a85e8bc1401d841f5a423186f406">Selina and Holly Road Trip It</h2>

<p>The trade drags a little after the Black Mask story completes with Selina, her sister, and Slam (who is an awesome character by the way) deal with the events that occurred in the previous story. There&rsquo;s some good stuff here, and Slam and Selina&rsquo;s relationship is revealing about both of their personalities; Selina wants a distraction whereas Slam wants something to anchor him to the real world. Ultimately though, aside from the gorgeous art, I felt that this middle section could have been left out.</p>

<p>After, however, we get a series of wonderful stories involving Selina and Holly going on a road trip and the adventures that follow from that. Wildcat makes an appearance and becomes Holly&rsquo;s trainer. Catwoman and Holly stumbling upon a robbery in a diner is my favorite.</p>

<p>This is what I really want from a Catwoman series, I&rsquo;ve decided. The 1 or 2 issue story arcs work well for the character as they allow her to explore the many sides of her personality, better. I&rsquo;m hoping that the 3rd trade continues with that, at least for a while.</p>

<h2 id="conclusion:40f7a85e8bc1401d841f5a423186f406">Conclusion</h2>

<p>This trade did exactly what a good trade is supposed to do; left me wanting more, but feeling satisfied for what I got. To that end I&rsquo;ve picked up volume 1, which features Brubaker along with Darwyn Cooke (who I&rsquo;ve liked in nearly everything he&rsquo;s done).</p>

<p>Although it stumbled just a little after the conclusion of the Black Mask story, it eventually turned into a series of smaller fun stories. I could have an ongoing of these types of Catwoman stories and you&rsquo;d get no complaints out of me.</p>

<p>Catwoman Volume 2 has made me rethink what is possible with characters who are seemingly one-dimensional. Brubaker tapped into the 60s aesthetic his artists gave him and used it to paint a wonderful tapestry of Selina Kyle living with his past and struggling to embrace the present. Is there any better compliment a writer can get?</p>

  </div>
  
</div>
</div>

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
