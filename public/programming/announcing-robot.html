<!doctype html>
<html lang="en">
<title>Announcing Robot</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../styles/main.css">
<link rel="icon" href="../images/html-icon.ico">
<link rel="alternate" type="application/atom+xml" title="Matthew Phillips Programming Blog" href="https://matthewphillips.info/programming/atom.xml">

<meta property="og:type" content="article">
<meta property="og:title" content="Announcing Robot">
<meta property="og:url" content="/programming/announcing-robot.html">
<meta property="og:description" content="Robot is a new library...">
<meta property="og:site_name" content="Matthew&apos;s Programming Blog">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@matthewcp">
<meta name="twitter:title" content="Announcing Robot">
<meta name="twitter:description" content="Robot is a new library...">
<meta name="twitter:image" content="">

<link rel="stylesheet" href="../styles/prism-cb.css">
<script type="module" src="../scripts/read-time.js"></script>

<header>
  <time>September 20, 2019</time>
  <read-time selector="main">min read</read-time>
  
  <h1>Announcing Robot</h1>
</header>

<main><p><strong><a href="https://thisrobot.life/">Robot</a></strong> is a new library for building <a href="https://en.wikipedia.org/wiki/Finite-state_machine">finite state machines</a> in only <strong>1.3kB</strong>. Here's an obligatory toggle machine example:</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> state<span class="token punctuation">,</span> transition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'robot3'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  inactive<span class="token punctuation">:</span> <span class="token function">state</span><span class="token punctuation">(</span></span><br><span class="highlight-line">    <span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'toggle'</span><span class="token punctuation">,</span> <span class="token string">'active'</span><span class="token punctuation">)</span></span><br><span class="highlight-line">  <span class="token punctuation">)</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  active<span class="token punctuation">:</span> <span class="token function">state</span><span class="token punctuation">(</span></span><br><span class="highlight-line">    <span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'toggle'</span><span class="token punctuation">,</span> <span class="token string">'inactive'</span><span class="token punctuation">)</span></span><br><span class="highlight-line">  <span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>One of the main goals of Robot is to enable <a href="https://thisrobot.life/guides/composition.html">function composition</a> so common tasks can be broken up. The above toggle machine does something common, the <code>toggle</code> event causes a transition to another state. So we can extract this to a function:</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> state<span class="token punctuation">,</span> transition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'robot3'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> <span class="token function-variable function">toggleTo</span> <span class="token operator">=</span> <span class="token parameter">to</span> <span class="token operator">=></span> <span class="token function">state</span><span class="token punctuation">(</span></span><br><span class="highlight-line">  <span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'toggle'</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  inactive<span class="token punctuation">:</span> <span class="token function">toggleTo</span><span class="token punctuation">(</span><span class="token string">'active'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  active<span class="token punctuation">:</span> <span class="token function">toggleTo</span><span class="token punctuation">(</span><span class="token string">'inactive'</span><span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>And of course, a toggle machine is a <em>super</em> common type of state machine. So we probably want to make that into its own function itself. Let's do that:</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> state<span class="token punctuation">,</span> transition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'robot3'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> <span class="token function-variable function">toggleTo</span> <span class="token operator">=</span> <span class="token parameter">to</span> <span class="token operator">=></span> <span class="token function">state</span><span class="token punctuation">(</span></span><br><span class="highlight-line">  <span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'toggle'</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> <span class="token function-variable function">toggleMachine</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  inactive<span class="token punctuation">:</span> <span class="token function">toggleTo</span><span class="token punctuation">(</span><span class="token string">'active'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  active<span class="token punctuation">:</span> <span class="token function">toggleTo</span><span class="token punctuation">(</span><span class="token string">'inactive'</span><span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> bold <span class="token operator">=</span> <span class="token function">toggleMachine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">const</span> italic <span class="token operator">=</span> <span class="token function">toggleMachine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">const</span> underline <span class="token operator">=</span> <span class="token function">toggleMachine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>Finite state machines are a <em>great</em> way to write stateful UIs. You can think about FSM as the static typing for state. If you declaratively lay out the possible states you'll avoid bugs like incompatible states.</p>
<p>One of the great things that has happened in programming over the last several years has been the migration toward declarative UIs with libraries like React. However, we still write the stateful logic in our components with imperative code like this:</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">function</span> <span class="token function">resetState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token function">setValidating</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token function">setSaving</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token function">setBlurred</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token function">setEditing</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>focused<span class="token punctuation">)</span> <span class="token function">setTouched</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token function">setDirty</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre>
<p>This is gross! Finite state machines fixes this. See <a href="https://thisrobot.life/#why-finite-state-machines">Why Finite State Machines</a> for a larger argument for why you should use FSMs in your app.</p>
<h2>Integrations</h2>
<p>Robot has integrations with a variety of popular view libraries including:</p>
<ul>
<li><a href="https://thisrobot.life/integrations/preact-robot.html">Preact</a></li>
<li><a href="https://thisrobot.life/integrations/haunted-robot.html">Haunted</a></li>
<li><a href="https://thisrobot.life/integrations/react-robot.html">React</a></li>
<li><a href="https://thisrobot.life/integrations/lit-robot.html">LitElement</a></li>
</ul>
<p>Here's an example of using Robot in a <a href="https://reactjs.org">React</a> app:</p>
<pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> createMachine<span class="token punctuation">,</span> state<span class="token punctuation">,</span> transition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'robot3'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useMachine <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-robot'</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">const</span> machine <span class="token operator">=</span> <span class="token function">createMachine</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span><br><span class="highlight-line">  off<span class="token punctuation">:</span> <span class="token function">state</span><span class="token punctuation">(</span></span><br><span class="highlight-line">    <span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'toggle'</span><span class="token punctuation">,</span> <span class="token string">'on'</span><span class="token punctuation">)</span></span><br><span class="highlight-line">  <span class="token punctuation">)</span><span class="token punctuation">,</span></span><br><span class="highlight-line">  on<span class="token punctuation">:</span> <span class="token function">state</span><span class="token punctuation">(</span></span><br><span class="highlight-line">    <span class="token function">transition</span><span class="token punctuation">(</span><span class="token string">'toggle'</span><span class="token punctuation">,</span> <span class="token string">'off'</span><span class="token punctuation">)</span></span><br><span class="highlight-line">  <span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>current<span class="token punctuation">,</span> send<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useMachine</span><span class="token punctuation">(</span>machine<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span><br><span class="highlight-line">    <span class="token operator">&lt;</span><span class="token operator">></span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span>div<span class="token operator">></span>State<span class="token punctuation">:</span> <span class="token punctuation">{</span>current<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'toggle'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span></span><br><span class="highlight-line">        Toggle</span><br><span class="highlight-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span></span><br><span class="highlight-line">    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span></span><br><span class="highlight-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span><br><span class="highlight-line"></span><br><span class="highlight-line">ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>
<p>That's it! I'm more excited about Robot than any project I've been in a quite a long time. I think the combination of small size and the power of composition is going to make it easier and fun to build apps again. Check out <a href="https://thisrobot.life">thisrobot.life</a> for more information and file an issue!</p>
</main>

<footer>
  <a href="./index.html">&#x2190; Programming Blog</a>
</footer>